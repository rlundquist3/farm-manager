{"version":3,"sources":["meteor://ðŸ’»app/packages/xolvio:cleaner/cleaner.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAI,OAAO,QAAX,EAAqB;AAAA;AACnB,QAAM,iBAAiB,SAAjB,cAAiB,CAAU,OAAV,EAAmB;AACxC,UAAI,QAAQ,GAAR,CAAY,QAAZ,KAAyB,aAA7B,EAA4C;AAC1C,cAAM,IAAI,KAAJ,CACJ,iEACA,WAFI,CAAN;AAID;;AAED,gBAAU,WAAW,EAArB;AACA,UAAI,sBAAsB,CAAC,gBAAD,CAA1B;AACA,UAAI,QAAQ,mBAAZ,EAAiC;AAC/B,8BAAsB,oBAAoB,MAApB,CAA2B,QAAQ,mBAAnC,CAAtB;AACD;;AAED,UAAI,KAAK,eAAe,6BAAf,GAA+C,KAA/C,CAAqD,EAA9D;AACA,UAAI,iBAAiB,OAAO,SAAP,CAAiB,GAAG,WAApB,EAAiC,EAAjC,CAArB;AACA,UAAI,cAAc,gBAAlB;AACA,UAAI,iBAAiB,EAAE,MAAF,CAAS,WAAT,EAAsB,UAAU,GAAV,EAAe;AACxD,eAAO,IAAI,cAAJ,CAAmB,OAAnB,CAA2B,UAA3B,MAA2C,CAA3C,IACL,oBAAoB,OAApB,CAA4B,IAAI,cAAhC,MAAoD,CAAC,CADvD;AAED,OAHoB,CAArB;;AAKA,QAAE,IAAF,CAAO,cAAP,EAAuB,UAAU,aAAV,EAAyB;AAC9C,YAAI,SAAS,OAAO,SAAP,CAAiB,cAAc,MAA/B,EAAuC,aAAvC,CAAb;AACA,eAAO,EAAP;AACD,OAHD;AAID,KA1BD;;AA4BA,WAAO,OAAP,CAAe;AACb,sCAAgC,oCAAU,OAAV,EAAmB;AACjD,uBAAe,OAAf;AACD;AAHY,KAAf;;AAMA,oBAAgB,uBAAS,OAAT,EAAkB,QAAlB,EAA4B;AAC1C,qBAAe,OAAf;AACA,UAAI,OAAO,QAAP,KAAoB,UAAxB,EAAoC;AAAE;AAAa;AACpD,KAHD;AAnCmB;AAwCpB;AACD,IAAI,OAAO,QAAX,EAAqB;AACnB,kBAAgB,uBAAS,OAAT,EAAkB,QAAlB,EAA4B;AAC1C,WAAO,IAAP,CAAY,8BAAZ,EAA4C,OAA5C,EAAqD,QAArD;AACD,GAFD;AAGD,4H","file":"/packages/xolvio_cleaner.js","sourcesContent":["if (Meteor.isServer) {\n  const _resetDatabase = function (options) {\n    if (process.env.NODE_ENV !== 'development') {\n      throw new Error(\n        'resetDatabase is not allowed outside of a development mode. ' +\n        'Aborting.'\n      );\n    }\n\n    options = options || {};\n    var excludedCollections = ['system.indexes'];\n    if (options.excludedCollections) {\n      excludedCollections = excludedCollections.concat(options.excludedCollections);\n    }\n\n    var db = MongoInternals.defaultRemoteCollectionDriver().mongo.db;\n    var getCollections = Meteor.wrapAsync(db.collections, db);\n    var collections = getCollections();\n    var appCollections = _.reject(collections, function (col) {\n      return col.collectionName.indexOf('velocity') === 0 ||\n        excludedCollections.indexOf(col.collectionName) !== -1;\n    });\n\n    _.each(appCollections, function (appCollection) {\n      var remove = Meteor.wrapAsync(appCollection.remove, appCollection);\n      remove({});\n    });\n  };\n\n  Meteor.methods({\n    'xolvio:cleaner/resetDatabase': function (options) {\n      _resetDatabase(options);\n    }\n  });\n\n  resetDatabase = function(options, callback) {\n    _resetDatabase(options);\n    if (typeof callback === 'function') { callback(); }\n  }\n\n}\nif (Meteor.isClient) {\n  resetDatabase = function(options, callback) {\n    Meteor.call('xolvio:cleaner/resetDatabase', options, callback);\n  }\n}\n"]}